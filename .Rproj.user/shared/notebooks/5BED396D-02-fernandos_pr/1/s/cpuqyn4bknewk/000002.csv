"0","# create column names based on the headers which contains info in qualification type, level and year"
"0","column_names <- headers %>% "
"0","  select(-c(1:3)) %>% "
"0","  # fill empty cells with the previous non-na value"
"0","  apply(1, zoo::na.locf) %>% "
"0","  as_data_frame() %>%"
"0","  # put them togetger"
"0","  unite(""x"", V1:V3) "
"0","# assign column names to the majors data frame"
"0","colnames(majors) <- c(""field_broad"", ""field_narrow"", ""field_detailed"", column_names$x)"
"0","# tidy qualifications"
"0","majors <- majors %>%"
"0","  # gather all columns except the ones that describe the field"
"0","  gather(""qualification"", ""Students"", -contains(""field"")) %>% "
"0","  # separate the qualification information into columns"
"0","  separate(""qualification"", c(""qual_level"", ""qual_type"", ""Year""), sep = ""_"")"
"0","  "
"0","majors <- majors %>%"
"0","  # Select only columns for students at bachelor degree level and higher"
"0","  filter(qual_level %in% c(""Bachelors degrees"", ""Honours & postgrad. cert/dips."", ""Masters"", ""Doctorates"")) %>%"
"0","  # Remove unneeded rows"
"0","  filter(!is.na(Students))"
"0","# Tidy up variable names"
"0","majors <- majors %>% "
"0","  mutate_at(vars(""field_broad"", ""field_narrow""), zoo::na.locf, na.rm = F) %>% "
"0","  # because of the way we did things we need to remove the "": Total"" string from"
"0","  # the fields"
"0","  mutate_at(vars(""field_broad"", ""field_narrow""), sub, pattern = "": Total"", replacement = """")"
"0","# Remove totals and subtotal"
"0","majors <- majors %>%"
"0","  filter(!is.na(field_detailed)) %>%"
"0","  # Don't need narrow field column"
"0","  select(-field_narrow) %>%"
"0","  # not interested in differences between domestic or international"
"0","  filter(qual_type == ""Total"") %>%"
"0","  select(-qual_type)"
